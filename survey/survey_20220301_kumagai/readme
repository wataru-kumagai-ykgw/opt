A backbone-centred energy function of neural networks for protein design

1章　はじめに
計算機によるタンパク質設計は大きな可能性を秘めており、新しい構造と機能を持つde novoタンパク質の設計を実証する画期的な研究6-13があり、そのほとんどは最先端のRosettaDesign法を用いて実施された6,13,14。
新しいバックボーンは、既存の構造モジュール（またはテンプレート）間の相対的な形状をパラメトリックに変化させ、ヘリックスバンドル11,15,16や繰り返しタンパク質17を設計するか、既存の構造からペプチドフラグメントを組み立てることで構築された6,8。
最近になって改良されたものの18,19、これらの方法では、テンプレートに依存するため、利用できる新しい構造の範囲が大きく制限され13,20,21、設計可能な機能性の範囲が狭くなる可能性があります。

設計可能性を決定する推定されるバックボーンを中心としたエネルギー表面を明示的に表現することで、テンプレートを使わないタンパク質設計ワークフローの基礎を提供することができます（図1a）。
これは、既存の手法とは根本的に異なるものであり、実質的に補完するものである可能性があります。
このような表現方法を確立するための進歩は遅く、おそらくde novoタンパク質設計タスクに必要なレベルで、関連する分子間相互作用を包括的かつ正確に表現する方法がないためと思われます。
以前の研究では、簡略化したバックボーンエネルギー面を探索したが、天然のバックボーンに似たブロードミニマムの存在を確認するためだけであった4,22,23。
例外は、局所的なバックボーンコンフォメーションの正確なモデリングを重視した、Cα原子ベースの統計的ポテンシャルであった24。
このモデルは、天然のフラグメントを鋳型にすることなく、de novoループの設計に成功しており25、バックボーンを中心としたアプローチの有効性を示している。

SCUBA（Side Chain-Unknown Backbone Arrangement）モデルは、ペプチド骨格の局所構造嗜好や水素結合の形状、キラリと光る側鎖や密に配置された側鎖に必要な骨格間スペースなど、骨格設計に不可欠な要素を表現し、de novoタンパク質設計に対応した網羅性と精度を持つことを目指しています3-5。
そのために、NC-NNと名付けた一般的な手法で訓練した統計的エネルギー項（ポテンシャル）を用いて、様々な相互作用を表現します（図1b-d）。
この名称は、まず生の構造データからカーネルベースの密度推定（つまり、隣接カウント）により統計的エネルギー値を推定し、次にポテンシャルを表現するためのニューラルネットワーク（完全連結3層パーセプトロン：図1dおよび補足方法）の学習を行うという2段階のプロセスを表しています。
NC-NNは統計的ポテンシャルの構築における主な技術的課題を解決し、得られたポテンシャルは連続的であることに加え、構造サンプリングや最適化に使用する計算しやすい関数値（および微分）を提供することができます。は、実際の構造物の複雑で高次元かつ高相関の分布を表現することができる。のデータを忠実に再現することができます。

我々は、SCUBAを用いた確率論的動力学（SD）シミュレーション26とデータ駆動型固定バックボーンアミノ酸配列選択プログラムABACUS2（参考文献27,28）を併用し、SCUBAによる設計可能なバックボーン空間の計算探索により、様々な設計仕様を満たすトポロジカル構造を持つタンパク質や新規でゼロから設計されたタンパク質を設計しました。
我々は、それぞれ独自に設計された配列と構造を持つ9つのde novoタンパク質のX線構造を報告する。


Fig. 1 | Template-free protein design facilitated by explicit representation 
of the backbone-centred energy landscape.


2章　Building statistical potentials with NC-NN
形式的には，構造変数の集合（Q とする）に依存する統計的ポテンシャルは， e(Q) = -ln(ρ_observed(Q)/ρ_reference(Q)) として定義することができる．
ここでρ_observed(Q)はQ空間に分布する観測データの確率密度、ρ_reference(Q)は理想化した参照系（つまり、相互作用e(Q)を欠いた系）の同じ変数の期待確率密度を示す。
e(Q)を学習するためのニューラルネットワーク学習(NN)に続く近隣カウント(NC)のワークフローを図1c, dに示す。

NCステップでは、Q空間（図1cのボックスで表現）において選択された任意のプローブ点Q_probeについて、その一点エネルギーe（Q_probe）を、隣接する観測データ点の数n_neighbours^observed（Q_probe）と隣接する参照データ点の数n_neighbours^reference（Q_probe）との比として推定する。
実構造物からの観測データ点と計算で求めた参照データ点を用いることで、カーネル法を用いてこの二つの数値を推定することができる。
カーネルの半径は学習データの局所密度に基づいて適応的に選択することができ、推定エネルギーの分解能と統計的不確実性の間のトレードオフをバランスさせることができる。

NNステップ（図1d）では、異なるプロービングポイントにおけるNC推定エネルギーを用いて、統計的ポテンシャルをQの解析的関数として符号化するためのニューラルネットワークを学習させる。
NCステップでは1点のエネルギーしか推定できず、離散的でノイズの多い値が得られるため、NNステップは元のデータを参照せずに効率的に計算できる解析的ポテンシャルを得るために不可欠なステップです。

特徴をビンに分けて統計的ポテンシャルを学習する従来のアプローチと比較した場合のNC-NNの主な利点は、以下の通りである。
NC-NNは高次元空間における相関を忠実に保持することができる。
例えば、拡張データ図1は、NC-NNで学習したSCUBAエネルギー項の14変数による低次元投影図である。
このデータはNC-NNによって捉えられた強い次元間相関を明確に示しており、観測された（主に好ましい）構成と計算で描かれた（主に好ましくない）構成を区別することができる。
低次元、高次元ともに、NC-NNによって学習されたポテンシャルは、(1)自動的に連続となり、(2)解析的勾配を持つため、勾配駆動の構造サンプリングや最適化に適している。
NC-NNは複雑なエネルギー面をニューラルネットワークで表現するという以前のアイデアに基づいているが29、生の構造データを用いて一点エネルギーを得るという点で、量子力学計算の利用とは根本的に異なることに注意されたい。


3章　The backbone-centred SCUBA model
SCUBAは、バックボーンを中心としたエネルギーランドスケープの様々な構造変数への依存性を包括的に検討するために考案されました。5種類のNC-NN学習されたエネルギー項を用いている（Extended Data Fig.2a）．
学習データは、Protein Data Bank (PDB)31にある12,000以上の非冗長自然構造27,30から構成されている。
ニューラルネットワークの項を通常の共有結合項および立体項と組み合わせて、解析的に原子直交座標に依存する有効エネルギー関数を形成した（詳細は補足方法を参照）。
エネルギー関数の（座標に対する）負の勾配を力として使用できるため、SCUBAはタンパク質構造のニュートンまたはランジュバン分子力学（MD）またはSDシミュレーションの駆動に使用することができる。

バックボーン中心で開発されたが、SCUBAはバックボーンに依存する項と明示的な側鎖に依存する項の両方を含んでいる。
側鎖が指定されていない場合、背骨の原子の位置が「不鮮明」であることがわかったため、側鎖を含めることにした（その結果、その後の配列選択で50％以上の位置でアラニンまたはグリシン残基が得られた）。
側鎖の種類に依存しない有用なレベルを維持しながらこのぼやけを最小限に抑えるため、SCUBAでは側鎖が関与する極性相互作用と溶媒和を省き、バックボーン依存のロータマーと立体充填項のみを用いて、明示的に側鎖を考慮しました。
この方法でモデル化すると、一般的に選択された側鎖（例えば、以下に述べる「LVG」形式の側鎖）は、バックボーン間の空間を埋めるプレースホルダーとして機能し、最終的に最適化されたバックボーンは、密に充填されたキラル側鎖を収容するための適切な空間を持つことができるようになりました。

33種類の天然タンパク質のSCUBA駆動SDシミュレーションを用いて、SCUBAの様々なエネルギー項の相対的な重みを較正した。
最終的に決定されたエネルギー重みをシミュレーションに使用した場合、中央値 主鎖の二乗平均平方根偏差（r.m.s.d.）が自然界と異なる。
構造は、ネイティブの側鎖を使用した場合1.60Å、2.78Åでした。LVGで簡略化された側鎖（後述）を使用した場合（Extended Data Fig. 2b; 全体的な構造のコンパクトさを抑制した場合 シミュレーションの結果、r.m.s.d.の中央値は、Native 配列、LVG配列を用いた場合は2.23Å)。

Fig. 2 | The de novo protein EXTD-3 integrates pre-existing and newly 
designed parts to form a single rigid architecture not yet observed in 
nature. a

4章　Template-free protein design using SCUBA
バックボーン生成にSCUBA、配列選択にABACUS2（文献28）を用いたde novoタンパク質設計ワークフローを考案した。
初期バックボーン（例えば、Extended Data Fig. 3に示した手順で得られたもの）から出発し、SCUBAによるシミュレーテッドアニーリングによるSDシミュレーション（SASD）を用いて、設計可能であると推定される最適化バックボーンを得ることができる。
SASDは、側鎖を考慮しない段階と、側鎖を考慮しない段階の2つの段階に分けて実施することができます。
(また、一般的に選択された側鎖を考慮した場合（例えば、αヘリックスにはロイシンを、βストランドにはバリンを均質に使用し、ループには側鎖を使用せず、LVG配列となる）、LVG配列は、そのような二次構造のバックボーンになります。） 
LVGで単純化された側鎖は比較的特徴がなく、中程度の大きさで、対応する二次構造のタイプと一致する好ましいバックボーンコンフォメーションを持っており、バックボーン中心のモデルで適切な側鎖プレースホルダーを得ることができます。
最終的な配列を選択する際に、このような側鎖で最適化されたバックボーンを微調整して特定の側鎖を収容するために、我々は反復配列選択-バックボーン緩和アプローチ6を使用して、ABACUS2 と SCUBA-drivenのSASDを逐次反復する。

SCUBA による SASD プロトコルを適用し、様々なトポロジカルアーキテクチャのスケッチの仕様を満たすバックボーンを最適化しました。
スケッチ（つまり目標とする構造）は、球状タンパク質構造の「周期表」抽象化に基づいて定義された32, を用い、それに合わせて初期バックボーンを幾何学的に構築した（Supplementary Methods and Extended Data 図3）。
SCUBAを用いたSASDは、スケッチの仕様を満たすバックボーンを一貫して生成するとともに、天然のバックボーンを高い精度で再現しました (Extended Data Fig. 4)。

目的の構造に酷似した初期構造（例えば、拡張データ図3のような初期構造）をSASDの出発点とすることで、構造空間での不必要な探索を避け、トポロジカルアーキテクチャを満たすタンパク質の設計を効率的に行うことができます。
このような初期構造は任意であり、むしろ「不格好」である可能性さえあります。
特に、「鎖」は鎖間水素結合を形成するために配置や向きを変える必要がない。
なぜなら、その後のSCUBA駆動型SASDでは、水素結合が自動的に形成、切断、再構成され、最終的にβシート全体にわたる水素結合ネットワークが形成されるからです（拡張データ、図5a）。
SASD 最適化プロトコルが初期バックボーンにほとんど制約を与えないことを考えると (デザインへの配慮は別として) 仕様および/または効率）、拡張データFig.3に示した方法の例以外にも、多様な方法で初期構造を構築することができる。

SCUBA駆動型SSDでは、拡張データ図4と図5aの構造を見るとわかるように、バックボーンは初期構造に対して大きく進化しています。
これは、拡張データ図5bの大きなr.m.s.d.値（6Åを超える）からも明らかである。
この過程で、バックボーンの物理的な妥当性が大幅に改善された。
このことをin silicoで実証するために、拡張データ図4のスケッチの初期および最適化バックボーンにABACUS2配列を選択し、残基あたりのABACUS2エネルギーとRosettaエネルギーを計算した（拡張データ図5c）。
最適化されたバックボーンに対して決定されたエネルギーは と比較して、常に1～2エネルギー単位低くなっている。
この結果は、設計のしやすさの向上と一致する。

側鎖を考慮しない）最初のバックボーン最適化の後、さらにSASD最適化（配列選択前はLVG側鎖、配列選択後は配列特異的側鎖を使用）を行った結果、バックボーン構造は微妙に変化しました（LVG側鎖追加によるr.m.s.d.は約3Å、さらなる側鎖更新では1.1Å以下；拡張データ図5bのスケッチの例参照）。
このことは、側鎖の種類は最適化されたバックボーンに実質的に影響を与えないという考えを支持しています。
しかし、意味のある配列選択を行うためには、第1段階からそれ以降の最適化段階までのバックボーンの調整が必要でした（Extended Data 図5d）。

初期プロトコルで設計した1つのde novoタンパク質について結晶構造を解いたが、実験結果から問題が明らかになった。
このプロトコルは、設計可能な正確なループ構造を一貫して生成しないのです。
つまり、バックボーン全体を一度に最適化すると、高エネルギーのローカルミニマムに捕捉されたループが含まれる可能性があり、ループの歪みが少ないことが設計可能なバックボーンの特徴であると理解されていることから、当然ながら設計の失敗の原因となります8, 10, 33. 
この問題を解決するために、ループの再サンプリングと最適化のステップ（SCUBA-driven SDも使用）を追加して、バックボーン最適化プロトコルを改良しました（Supplementary Methods）。
2本らせん/4本鎖（H2E4）スケッチ（拡張データ図5a）に適用したところ、改良されたプロトコルはループ領域のエネルギーを大幅に改善し（拡張データ図6a）、Rosettaバイアス順折りたたみ10、15を用いた場合の最終配列の計算による折りたたみの成功率を改善しました（拡張データ図6b、c）。

Fig. 3 | Successfully designed two-layered α/β proteins and
four-helix bundle proteins


5章　Verifying designs of given architecture
我々は、与えられたトポロジカルアーキテクチャで設計されたタンパク質を2バッチに分けて実験的にテストした（詳細なプロセスは補足の方法、要約は拡張データ表1a、正確な配列は補足表1および2を参照）。
これらのアーキテクチャには、H2E4スケッチ（拡張データ図5a）、いくつかの4ヘリックスバンドル（H4）スケッチ、および天然タンパク質ドメイン内のループを4ヘリックスからなる設計セグメントで置き換えたEXTDスケッチが含まれています（図2）。

バッチ1のタンパク質は、ループリサンプリングを行わず、バックボーン最適化プロトコルを用いて設計されました（上述）。
試験した44のH2E4またはH4設計のうち、結晶化に成功したものはなかった。
8つのEXTD設計のうちの1つ（EXTD-3）について、解決された結晶構造が得られた（Extended Data 図7aは、この研究で報告されたX線構造のデータ要約を示す）。
図2aは、解かれた構造と設計モデルを重ね合わせたものである。
その結果、カスタムメイドの初期構造（図2b）のヘリックス-ループ-ヘリックスセグメントが、SCUBA駆動のSASD中に単一の連続ヘリックスに変化し、非天然の全体構造が得られた（図2c）。
解決された構造では、設計上導入された3つのループのうち、1つは設計モデルと正確に一致していますが、他の2つは大きく外れています（図2a）。

バッチ1のタンパク質で明らかになった実験と設計の構造のこれらの不一致は、バックボーン最適化プロトコルにループ再サンプリングと最適化のステップを追加することにつながりました。
この修正プロトコルをH2E4とH4のスケッチに適用し、Rosettaバイアスフォワードフォールディング9,14によって設計配列をフィルタリングしました（中間設計段階で保持された構造または配列の数については、拡張データ表1bを参照してください）。
フィルタリング後に保持された38の配列が、バッチ2のタンパク質を構成しています。
このうち、12個のH2E4タンパク質と4個のH4タンパク質がモノマーとして精製され、X線結晶構造（2個のH2E4タンパク質と3個のH4タンパク質；図3a-e）または核磁気共鳴（NMR）異核単一量子コヒーレンス（HSQC）スペクトルによって、うまく折りたたまれていた（10個のH2E4タンパク質（拡張データ図7b）と1個のH4タンパク質（図3f））。
2つのH2E4タンパク質の非対称結晶ユニットには2量体が含まれていたが、サイズ排除クロマトグラフィーにより、これらのタンパク質が溶液中で単量体であることが確認された（Extended Data 図7c）。

SCUBAで設計したバックボーンは、X線構造と設計構造の間で観測された主鎖のr.m.s.d.値0.96-1.85Åが示すように、実験的に得られた構造と原子レベルで一致しました（図3a-e）。
さらに、設計した構造中の19個のループのうち16個は、実験的に精製したループとオングストローム以下の精度で一致しました（拡張データ図8a-e）。
特に、2つのH2E4タンパク質は、二次構造が同じように詰まっているにもかかわらず、同じループのコンフォメーションを持っていなかった（Extended Data 図8f）。

設計されたH2E4およびH4タンパク質は、類似した構造を持つ既知の天然タンパク質との配列同一性が低く、構造的に整列した天然タンパク質配列との同一性は3.5-25%（平均同一性は14%）を示し、ネイティブ配列と天然バックボーンのために選択したABACUS2配列間の平均配列同一性（〜33%）よりはるかに低い28。
設計されたタンパク質は、2つの例となるタンパク質の温度依存性円二色性分光データ（拡張データ図7d）が示すように、天然骨格にABACUS配列を選択したタンパク質34と同様に高い耐熱性を持っている。
バッチ2のタンパク質の設計成功率は約42%であった（実験的にテストされた38個のタンパク質のうち、16個がうまく折りたたまれた。
この成功率には、設計後の計算機によるフィルタリングが寄与していることを認めます）。
これらの結果から、SCUBA+ABACUS2は、最先端のRosettaDesign法6,14と並んで、de novoタンパク質設計に有用な方法であることが示唆された。


Fig. 4 | Structures of successfully designed de novo proteins that fold into novel architectures

6章　Verifying designs of novel architecture
実験的に調べた3番目のタンパク質は、計算によって見出された新しい構造を持っていた（Extended Data 図9）。
これらの全ヘリカル構造は、最初にランダムに配置されたヘリカル骨格セグメントをSCUBA駆動型SASD最適化し、その後、セグメントの切断と順序付けを行い、SCUBA最適化ループでセグメントを接続することで生成した（Supplementary Methods）。
バッチ3の13個のタンパク質のうち、3個は単量体の形で精製され、うまく折りたたまれていることがわかった（Extended Data Fig.7bのHSQC spectraを参照）。
これらの3つのタンパク質を（別々に）マンノース結合タンパク質（MBP）に融合させることで、タンパク質の結晶化が可能になりました。
X線構造解析の結果、図4a-cに設計した構造との重ね合わせで示した。

図4d-fは、設計したタンパク質とPDBで見つかった最もよく似た天然（部分）構造の重ね合わせで、これら3つのタンパク質の構造の新規性を示している。
これらのタンパク質の設計におけるSCUBAの成功は、（1）現在PDBで知られているタンパク質構造は（少なくとも可能なタンパク質構造の膨大さと比較して考えた場合）限られていること、（2）SCUBA駆動設計はモデルの訓練に使用される天然タンパク質構造に制限されないことを強調するものである。


7章　Discussion
私たちのアプローチは、既存のタンパク質設計手法とは異なる複数の特性を備えています。
SCUBAを使用する場合、バックボーン構造を連続的かつ柔軟にサンプリングし、最適化することができます。
さらに、バックボーンを中心としたSCUBAモデルは、バックボーン設計の段階で配列空間を探索する必要がありません。
この2つの特性により、自然界で観測されていない全く新しいバックボーン構造を容易に探索することができます。

本研究で得られた新しい構造のタンパク質は、自然界で観察されるよりも幅広い形状のタンパク質を設計するために、本研究のアプローチが有用であることを明確に示しています。
機能性タンパク質を設計する際、エネルギー関数駆動型のバックボーンサンプリングと最適化は、サンプリング技術の向上による構造空間の広範な探索と、機能関連の拘束を適用することによる設計構造の精密な制御の両方を容易に行うことができる。
これらのアプローチにより、de novoタンパク質設計で利用可能な構造の多様性と機能性を大幅に拡大することができます。
